3.1 P-Channel interface specification

This section describes the P-Channel interface that controls power state transitions. For the purposes of this specification:
Lower-power state
    Typically is a state for which:
    • The power consumption is lower.
    • The device has less functionality, performance, or state retention than higher states.

Higher-power state
    Typically is a state for which:
    • The power consumption is higher.
    • The device has more functionality, performance, or state retention than lower states.

3.1.1 P-Channel Signals
Figure 3-1 shows the P-Channel signals between a device and a power controller.
A P-Channel interface comprises the following signal groups.

Device activity indication
This group comprises an N-bit signal, PACTIVE[N-1:0]:
• Each PACTIVE bit presented at a controller can be composed from a number of source signals. To provide wakeup capabilities, these source signals can include device input signals. Each PACTIVE bit is driven either directly by a register or by one or more registers and input signals whose outputs are logically combined. P-Channel implementation on page 3-57 gives implementation recommendations for PACTIVE combining logic.
• All bits of PACTIVE are independent of each other and might come from various asynchronous sources. For more information, see P-Channel implementation on page 3-57.

Handshake mechanism
This group manages device power state transitions. The group has the following signals:
PSTATE[M-1:0]: The power state to which a transition is requested.
PREQ: Active HIGH request to transition to the power state indicated by PSTATE.
PACCEPT: Active HIGH acceptance of the transition to the requested power state.
PDENY: Active HIGH denial of the power state transition request.

PREQ, PACCEPT, and PDENY form a handshake interface that is used to manage and guarantee safe state transitions. The handshake interface has a transition request signal, PREQ driven by a controller and an acknowledgment signal pair, PACCEPT and PDENY, which are driven by a device to indicate acceptance or denial of a request.

The P-Channel specification requires that only one of PACCEPT or PDENY changes on a single handshake transition. This ensures that the interface can be implemented safely across asynchronous boundaries. PACCEPT is used to accept a request, and PDENY is used to deny a request.

The PACCEPT and PDENY signals from a device and the PREQ and PSTATE signals from a controller must all be driven directly by registers. PSTATE enumerations are IMPLEMENTATION DEFINED. It is recommended to use the values defined in the Power Policy Unit Specification for compatibility. See Arm® Power Policy Unit, Architecture Specification, Version 1.1 for more information.

The purpose of the denial mechanism is to enable a device to maintain its current state while also having a mechanism by which it can promptly complete the handshake. This means the controller can make another request, possibly to a different state, if there are changes in the system conditions.

The polarities of the handshake signals are organized so they start and end each transition in a LOW state. This facilitates simple default isolation rules.

The handshake signal states are independent of the PACTIVE bits. Transitions on PACTIVE bits are not restricted by the values on PREQ, PACCEPT, and PDENY.

The P-Channel interface also has protocol relationships to the device, or device partition, reset. For a device with multiple resets, the reset relationships specified here are for the reset associated with the device P-Channel logic. In this specification, the name RESETn is used to represent this reset signal. However, the actual reset naming and polarity is outside the scope of this specification, and not restricted by this specification provided the relationships described are observed. Device reset and initialization on page 3-43 describes reset and initialization transitions.

3.1.2 P-Channel handshake
This section describes the permitted variations of the P-Channel interface handshake.
Accepted state transition
Figure 3-2 shows a transition request from State A to State B that is accepted by the device.

Figure 3-2 omits PACTIVE because although PACTIVE can act as a stimulus for the controller to initiate a transition request, it is independent of the handshake. All transition requests can be initiated by the controller alone.
The transitions shown in Figure 3-2 are:
• At T0, the interface is idle and all signals are LOW. The interface state is P_STABLE and the device remains in its current state.
• At T1, recognizing that a handshake request is required, the power controller must take any necessary pre-transition actions prior to requesting a new state. These actions are typically associated with a transition to a higher-power state. This might include powering up a domain or bringing RAM out of the retention state. The interface state remains P_STABLE.
• At T2, the power controller puts the required power state value on PSTATE and sets PREQ HIGH. The interface state is now P_REQUEST. The protocol requires that PSTATE is stable when PREQ going HIGH is detected at the device. This is typically achieved by resynchronizing PREQ to the device clock domain and using it to capture PSTATE.
— A controller must only present supported PSTATE values and transitions to a device. See Device power state and transition support definition on page 3-49.
• At T3, the device accepts the transition by driving PACCEPT HIGH. PDENY must be kept LOW. The device can now use the capabilities of any higher state. The interface state is now P_ACCEPT.
• At T4, the power controller samples PACCEPT HIGH and sets PREQ LOW. The interface state is P_COMPLETE.
• At T5, the device samples PREQ LOW and sets PACCEPT LOW. Once the controller samples PACCEPT LOW, it can take any post-transition actions required. These actions are typically associated with transitioning to a lower-power state. This might include removing power from a power domain or placing a RAM into a retention state. The transition is now complete and the interface state returns to P_STABLE. When moving to a lower-power state after setting PACCEPT LOW, the device cannot assume the availability of any properties of a previous higher-power state.

Handshake rules
The handshake signaling rules are:
• PREQ can only transition from LOW to HIGH when PACCEPT and PDENY are both LOW.
• PREQ can only transition from HIGH to LOW when either:
— PACCEPT is HIGH and PDENY is LOW.
— PACCEPT is LOW and PDENY is HIGH.
• PSTATE can only transition when either:
— PREQ, PACCEPT, and PDENY are all LOW.
— PREQ and PDENY are both HIGH and PACCEPT is LOW.
• PACCEPT can only transition from LOW to HIGH when PREQ is HIGH and PDENY is LOW.
• PACCEPT can only transition from HIGH to LOW when PREQ is LOW and PDENY is LOW.
• PDENY can only transition from LOW to HIGH when PREQ is HIGH and PACCEPT is LOW.
• PDENY can only transition from HIGH to LOW when PREQ is LOW and PACCEPT is LOW.